/*
@@@ !name: vip-book-1.0.0-2014-03-12
*/
function setBackAct(a){var b="";switch(a){case"topHeaderUserHome":b="user.html";break;case"topHeaderCart":b="cart.html";break;case"topHeaderLogistics":b="user-order-list-unreceive.html"}""!=b&&(document.cookie="WAP[back_act]="+b)}function trim_str(a){return"string"==typeof a?a.replace(/^\s*|\s*$/g,""):a}function getbookArea(a,b){var c=a.options;if(null==c)return!1;for(var d=null,e=0;e<c.length;e++)if(1==c[e].selected){d=c[e].value;break}$.get("index.php?m=user&act=address&step=ajax",{type:b,id:d},function(a){var c='<option value="0">请选择</option>';if("city"==b){for(var d=0;d<a.length;d++)a[d].city_id&&a[d].city_name&&(c+='<option value="'+a[d].city_id+'">'+a[d].city_name+"</option>");$("#district").html('<option value="0">请选择</option>'),$("#street").html('<option value="0">请选择</option>')}else if("district"==b){for(var d=0;d<a.length;d++)a[d].district_id&&a[d].district_name&&(c+='<option value="'+a[d].district_id+'">'+a[d].district_name+"</option>");$("#street").html('<option value="0">请选择</option>')}else if("street"==b)if(a.length>0)for(var d=0;d<a.length;d++)a[d].street_id&&a[d].street_name&&(c+='<option value="'+a[d].street_id+'">'+a[d].street_name+"</option>");else c='<option value="-1">无</option>';$("#"+b).html(c)},"json")}function getPostcode(){var a=$("#district").val();0==a?VsmwebForm.erDialog("请选择区"):$.ajax({url:"index.php?m=user&act=address&step=edit&filter=getPostcode",data:"district="+a,type:"POST",dataType:"json",success:function(a){"-1"==a.code?VsmwebForm.erDialog("请选择区"):$("#postcode").val(a.zipcode)}})}function revision_change(a){"HD"==a?$.get("index.php?m=ajax&act=revision",{hd:1},function(a){if(1==a.code){var b='<a href="javascript:void(0)" onclick="revision_change(\'\')"><span class="">触屏</span><span class="cur">高清</span></a>';$("#header .head_left.revision_change")&&$("#header .head_left.revision_change").html(b),setTimeout(function(){window.location.reload()},2e3),VsmCart.VsmDialog("正在切换到高清版",{setClass:"ui-info",position:[{top:0},{left:0}],overClose:!1,overShow:!1,width:"100%",autoClose:3e3})}},"json"):$.get("index.php?m=ajax&act=revision",{hd:0},function(a){if(1==a.code){var b='<a href="javascript:void(0)" onclick="revision_change(\'HD\')"><span class="cur">触屏</span><span class="">高清</span></a>';$("#header .head_left.revision_change")&&$("#header .head_left.revision_change").html(b),setTimeout(function(){window.location.reload()},2e3),VsmCart.VsmDialog("正在切换到触屏版",{setClass:"ui-info",position:[{top:0},{left:0}],overClose:!1,overShow:!1,width:"100%",autoClose:3e3})}},"json")}function shakeScroll(a,b,c,d){window.scroll(0,a.offsetTop-40),a=a.children[c];var e=arguments[4]?arguments[4]:200,f=0,g=!1,h=a.className,i="",d=d||2;g||(g=setInterval(function(){f++,i=f%2?h+" "+b:h,a.className=i,f==2*d&&(clearInterval(g),a.className=h)},e))}function download(a,b,c){return a.length<1||b.length<1?!1:void $.post("index.php?m=service&service=download",{client:a,platform:b},function(a){1==a&&(location.href=c)},"json")}function grab_red_packet(){$.get("index.php?m=lottery&act=gograb",{},function(a){null!=a&&(1==a.error&&a.url?location.href=a.url:a.content&&($(".envelope_step1").css("display","none"),$(".envelope_step2").html(a.content),$("#mobile").select()))},"json")}function verificode(){var a=document.getElementById("mobile").value,b=/^13[0-9]{9}$|14[0-9]{9}|15[0-9]{9}$|18[0-9]{9}$/;if(!b.test(a))return VsmwebForm.erDialog("手机号码错误：手机号码格式不正确"),document.getElementById("mobile").select(),!1;var c=document.getElementById("lottery_fc").value;$("#getcode").val("验证码获取中"),$.get("index.php?m=lottery&act=getcode",{mobile:a,from:c},function(a){1==a.error?VsmCart.VsmDialog(a.description,{setClass:"ui-error",position:[{top:0},{left:0}],overClose:!1,overShow:!1,width:"100%",autoClose:3e3}):1==a.status?(VsmCart.VsmDialog("验证码发送成功，请注意查收短信",{setClass:"ui-success",position:[{top:0},{left:0}],overClose:!1,overShow:!1,width:"100%",autoClose:3e3}),document.getElementById("referrer_uid").value=a.referrer_uid,a.veriCode&&null!=a.veriCode&&(document.getElementById("code").value=a.veriCode)):0==a.status&&VsmwebForm.erDialog(a.description),$("#getcode").val("获取验证码")},"json")}function chk_verificode(){var a=document.getElementById("mobile").value,b=document.getElementById("code").value,c=document.getElementById("referrer_uid").value,d=document.getElementById("lottery_fc").value,e=/^13[0-9]{9}$|14[0-9]{9}|15[0-9]{9}$|18[0-9]{9}$/;return e.test(a)?b.length<4?(VsmwebForm.erDialog("验证码错误"),document.getElementById("code").select(),!1):($("#subcode").val("领取中"),void $.get("index.php?m=lottery&act=chkcode",{mobile:a,code:b,referrer_uid:c,from:d},function(a){1==a.error?VsmwebForm.erDialog(a.description):1==a.status?(a.favourable&&(VsmCart.VsmDialog("恭喜您获得"+a.favourable.money+"元红包",{setClass:"ui-success",position:[{top:0},{left:0}],overClose:!1,overShow:!1,width:"100%",autoClose:3e3}),$(".dc_share .fblod").text("恭喜您获得"+a.favourable.money+"元红包！")),$(".sharetofrieds span").text(a.domain+"?a="+a.encryptedUserId),$("#encryptedUserId").val(a.encryptedUserId),$("#favourable_amount").val(a.favourable_amount),$(".downline").html(a.output),$(".dc_share").css("display",""),$(".envelope_step2").html("")):0==a.status&&VsmwebForm.erDialog(a.description),$("#subcode").val("领取福包")},"json")):(VsmwebForm.erDialog("手机号码错误：手机号码格式不正确"),document.getElementById("mobile").select(),!1)}function dragon_sign(){$.get("index.php?m=sign&act=sign",{},function(a){if(1==a.error&&a.url)return location.href=a.url,!1;if((1==a.sign_status||1==a.today_is_signed)&&$("#sing_step1").hide(),a.sign_status?a.total_sign&&(a.total_sign<5?$("#total_sign").html(a.total_sign):$("#sign_msg").html('您已签到<b class="fontred">5</b>天啦!<br> 有机会赢得<span class="fontbg">719当天全额免单</span>！<br/>8月2日公布，敬请期待~')):a.description&&($("#sign_msg").html(a.description),$("#sign_msg").css("display","")),$(".sing_step2").css("display",""),a.signs){for(var b="<tr><th>日期</th><th>签到时间</th></tr>",c=0;c<a.signs.length;c++)b+="<tr><td>"+a.signs[c].date+"</td><td>"+a.signs[c].time+"</td></tr>";$("#mysignbook").show(),$("#mysignbook table").html(b)}},"json")}function private_check_code(a){var b=document.getElementById("verify_code").value,c=a;return b?($("#submit").val("验证中..."),void $.post("index.php?m=private",{verify_code:b},function(a){$("#submit").val("立即进场"),"1"==a.code?VsmCart.VsmDialog(a.msg,{setClass:"ui-success",position:[{top:0},{left:0}],overClose:!1,overShow:!1,width:"100%",autoClose:3e3}):"0"==a.code&&(VsmCart.VsmDialog(a.msg+"3秒后将为您跳到专场页面",{setClass:"ui-info",position:[{top:0},{left:0}],overClose:!1,overShow:!1,width:"100%",autoClose:3e3}),setTimeout(function(){window.location.href="brand-index-"+c+"-0-1-10-0-0-1-0-0.html?m=brand&brand_id="+c},3e3))},"json")):(VsmwebForm.erDialog("验证码不能为空"),!1)}function getLocalStorageItem(){if(window.localStorage){var a=localStorage.getItem("emptycart");return a=parseInt(a),window.android.getLocalStorage(a)}}function rssByMobile(){var a=document.getElementById("mobile").value,b=/^13[0-9]{9}$|14[0-9]{9}|15[0-9]{9}$|18[0-9]{9}$/;return b.test(a)?void $.get("activitysys-915-list.html?do=rss",{mobile:a},function(a){500==a.code?alert(a.msg):200==a.code&&alert(a.msg)},"json"):(VsmwebForm.erDialog("手机号码格式不正确"),!1)}function register_check(a){for(var b=arguments[1]?arguments[1]:0,c=a.act.value,d=a.step.value,e=trim_str(a.username.value),f=trim_str(a.pwd.value),g=trim_str(a.pwd2.value),h=trim_str(a.captcha.value),i=a.sex,j=-1,k=0;k<i.length;k++)1==i[k].checked&&(j=i[k].value);var l=/^13[0-9]{9}$|14[0-9]{9}|15[0-9]{9}$|18[0-9]{9}$/,m=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/,n=/^[a-zA-Z]{6,20}$/;if(e.length<1)return VsmwebForm.erDialog("请输入正确的手机号或邮箱"),a.username.select(),!1;if(!l.test(e)&&!m.test(e))return VsmwebForm.erDialog("用户名错误：用户名为邮箱地址或手机号码"),a.username.select(),!1;if(f.length<1)return VsmwebForm.erDialog("请输入密码"),a.pwd.select(),!1;if(f.length<6||f.length>20)return VsmwebForm.erDialog("密码格式错误：请输入6-20位字母和数字的组合"),a.pwd.select(),!1;if(!isNaN(f)||"-1"!=f.search(n))return VsmwebForm.erDialog("密码格式错误：请使用字母和数字组合"),a.pwd.select(),!1;if(f!=g)return VsmwebForm.erDialog("两次输入密码不一样"),a.pwd2.select(),!1;if(0>j)return VsmwebForm.erDialog("请选择性别"),!1;if(h.length<1)return VsmwebForm.erDialog("请输入验证码"),a.captcha.select(),!1;var o=auth_data(e,hex_md5(f),hex_md5(g));1==b?$.post("index.php",{v:ui,m:"user",act:c,step:d,data:o,sex:j,captcha:h},function(b){return null==b?!1:"error"==b.error?(VsmwebForm.erDialog(b.title),null!=a.captcha&&(document.getElementById("captcha").src="index.php?m=captcha&"+Math.random()),1==b.user_exists&&a.username.select(),!1):0==b.error&&b.url.length>0?(location.href=b.url,!1):void 0},"json"):(a.username.value="",a.pwd.value="",a.pwd2.value="",a.data.value=o,a.submit())}function login_check(a){var b=arguments[1]?arguments[1]:0,c=a.act.value,d=a.step.value,e=a.back_act.value,f=trim_str(a.username.value),g=trim_str(a.pwd.value),h=a.remember.checked;if(h=1==h?1:0,f.length<1)return VsmwebForm.erDialog("请输入正确的手机号或邮箱"),a.username.select(),!1;if(g.length<1)return VsmwebForm.erDialog("请输入密码"),a.pwd.select(),!1;if(g.length<6||g.length>20)return VsmwebForm.erDialog("请输入6-20位密码"),a.pwd.select(),!1;var i=document.getElementById("li_captcha").style.display;if("none"!=i&&null!=a.captcha){var j=a.captcha.value;if(j.length<1)return VsmwebForm.erDialog("请输入验证码"),a.captcha.select(),!1}var k=auth_data(f,hex_md5(g));1==b?$.post("index.php",{m:"user",act:c,step:d,back_act:e,data:k,captcha:j,remember:h},function(b){return null==b?!1:"error"==b.error?(VsmwebForm.erDialog(b.title),1==b.use_captcha&&(document.getElementById("li_captcha").style.display=""),null!=a.captcha&&(document.getElementById("captcha").src="index.php?m=captcha&"+Math.random()),!1):0==b.error&&b.url.length>0?(location.href=b.url,!1):void 0},"json"):(a.username.value="",a.pwd.value="",a.data.value=k,a.submit())}function auth_data(a,b,c){var d="",e=Date.parse(new Date)/1e3,d=rstr2b64(a)+":"+rstr2b64(e.toString())+":"+rstr2b64(b),c=arguments[2]?arguments[2]:"";return c.length>0&&(d+=":"+rstr2b64(c)),d}var Cookie=function(){var a={raw:function(a){return a},decoded:function(a){return decodeURIComponent(a.replace(/\+/g," "))},converted:function(b){0===b.indexOf('"')&&(b=b.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return a.json?JSON.parse(b):b}catch(c){}},Set:function(b,c,d,e,f){if(void 0!==c){if("number"==typeof d){var g=expires=new Date;expires.setTime(g.getTime()+36e5*d)}return c=a.json?JSON.stringify(c):String(c),document.cookie=[b,"=",a.raws?c:encodeURIComponent(c),d?";expires="+expires.toUTCString():"",e?";domain="+e:"",f?";path="+f:""].join("")}},Get:function(b){for(var c=a.raws?a.raw:a.decoded,d=document.cookie.split("; "),e=b?void 0:{},f=0,g=d.length;g>f;f++){var h=d[f].split("="),i=c(h.shift()),j=c(h.join("="));if(i&&i===b){e=a.converted(j);break}b||(e[b]=a.converted(j))}return e},Del:function(b,c,d){var e=new Date(0),f=a.Get(b);null!=f&&(document.cookie=[a.raws?b:encodeURIComponent(b),"=",";expires="+e.toUTCString(),c?";domain="+c:"",d?";path="+d:""].join(""))}},b={versions:function(){{var a,b=navigator.userAgent.toLowerCase();navigator.appVersion}return{trident:b.indexOf("trident")>-1,presto:b.indexOf("presto")>-1,webKit:b.indexOf("applewebkit")>-1,gecko:b.indexOf("gecko")>-1&&-1==b.indexOf("khtml"),isMobile:!!b.match(/applewebkit.*mobile.*/)||!!b.match(/applewebkit/),isIos:!!b.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),isAndroid:b.indexOf("android")>-1||b.indexOf("linux")>-1,isIPhone:b.indexOf("iphone")>-1||b.indexOf("mac")>-1,isIPad:b.indexOf("ipad")>-1,isSafari:(a=b.match(/version\/([\d.]+).*safari/))?a[1]:0,webApp:-1==b.indexOf("safari")}},language:(navigator.browserLanguage||navigator.language).toLowerCase(),devicesInfo:function(){var a=document.body,b=window;return{cWidth:a.clientWidth,cHeight:a.clientHeight,sWidth:b.screen.width,sHeight:b.screen.height,offWidth:a.offsetWidth,offHeight:a.offsetHeight,acWidth:b.screen.availWidth,acHeight:b.screen.availHeight,wWidth:b.innerWidth,wHeight:b.innerHeight,wOri:b.orientation}}};return{Get:a.Get,Set:a.Set,Del:a.Del,Browser:b.versions}}(),VsmwebForm=function(){var a=$('[data-getvercode="code"]'),b=$("[data-bindmethod]"),c=$('[data-bindpsw="password"]'),d=$("[data-fbmethod]"),e=$('[data-mersale="true"]'),f=$(".bottomdiv"),g=$('[data-beautycart="true"]'),h=$('[data-choosewrap="brand"]'),i=$('[data-OrderFrom="true"]'),j=$('[data-OrderFailFrom="true"]'),k=$('[data-cartforms="time"]'),l=$('[data-cartforms="payway"]'),m=$('[data-cartforms="invoice"]'),n=$('[data-twicecart="payway"]'),p=$('[data-twicecart="wallet"]'),q=$('[data-tabsel="tab"]'),r=$(".use-bonus"),s=$("[data-favorable]"),t=$('input[data-check="checkall"]'),u=$("[data-addbonus]"),v=$('[data-orderreturn="list"]'),w=$('[data-orderreturn="reason"]'),x=$('[data-orderreturn="way"]'),y=$('[data-submitreturn="order"]'),z=$('[data-commit="address"]'),A=$('[data-address="del"]'),B=$('[data-selcoupon="true"]'),C=$('[data-catetype="cart"]'),D=$('[data-carttype="bank"]'),E={e:/^[a-zA-Z0-9]+[a-zA-Z0-9_.-]+[a-zA-Z0-9_-]+@[a-zA-Z0-9]+[a-zA-Z0-9.-]+[a-zA-Z0-9]+.[a-z]{2,4}$/,m:/^13[0-9]{9}$|14[0-9]{9}|15[0-9]{9}$|18[0-9]{9}$/,s:/^[A-Za-z]{6,20}$/,c:/^[\u4e00-\u9fa5]{1,8}$/},F={erDialog:function(a){VsmCart.VsmDialog(a,{setClass:"ui-error",position:[{top:0},{left:0}],overClose:!1,overShow:!1,width:"100%",autoClose:3e3})},erCenDialog:function(a){VsmCart.VsmDialog(a,{title:"友情提示",overClose:!1,buttons:!0})}},G={tiggerLoginBaddCartinit:function(){var a=$('[data-loginaddcart="true"]'),b={elem:a,bookcart:$('[data-bookcart="true"]'),jump:a.data("addjump"),anItem:a.data("animate"),size:a.data("sid"),num:1,product_id:a.data("pid"),channel_id:a.data("chid"),cat_id:parseInt(a.data("catid")),warehouse:a.data("wh"),product_name:a.data("pname"),small_image:a.data("simg"),vipbook_price:parseInt(a.data("vpic")),market_price:parseInt(a.data("mpic")),agio:a.data("agio"),back_url:encodeURIComponent(location.href)};G.tiggerBeautyaddCartDo(b)},tiggerBeautyaddCartinit:function(){var a=$(this),b={elem:a,bookcart:$('[data-bookcart="true"]'),jump:a.data("addjump"),anItem:a.data("animate"),size:a.data("sid"),num:1,product_id:a.data("pid"),channel_id:a.data("chid"),cat_id:parseInt(a.data("catid")),warehouse:a.data("wh"),product_name:a.data("pname"),small_image:a.data("simg"),vipbook_price:parseInt(a.data("vpic")),market_price:parseInt(a.data("mpic")),agio:a.data("agio"),back_url:encodeURIComponent(location.href)};G.tiggerBeautyaddCartDo(b)},tiggerBeautyaddCartDo:function(a){var b=J.tiggerIsEmpty(a.size),c=J.tiggerIsEmpty(a.product_id),d=J.tiggerIsEmpty(a.num);if(!c)return F.erDialog("无法加入购物车：未知异常"),!1;if(!b)return F.erDialog("无法加入购物车：未知异常"),!1;if(!d||a.num>1||a.num<=0)return F.erDialog("无法加入购物车：请勿修改数量"),!1;if(1==a.jump){$("<div />",{"class":"lmask"}).html('<img src="view/touch/images/common/loading-big.gif" style="width:20px;" />').appendTo(a.elem.parent());var e={url:"index.php?",data:{m:"flow",act:"addtocart",channel_id:a.channel_id,product_id:a.product_id,size:a.size,num:a.num,cat_id:a.cat_id,warehouse:a.warehouse,product_name:a.product_name,small_image:a.small_image,vipbook_price:a.vipbook_price,market_price:a.market_price,agio:a.agio,back_url:a.back_url},dataType:"json",type:"GET"};e.error=function(){a.elem.next().remove(),F.erDialog("网络延时，请刷新页面重试！")},e.success=function(b){if(a.elem.next().remove(),0==b.code&&b.add_num>0){var c={elem:a.bookcart.children().find(".flow_cart_time"),time:b.clear_time,timeUnitCls:{day:"",hour:"",min:":",sec:""},showMin:!0,action:"remain",onEndCallBack:!0,onEndComplete:function(){this.parent().parent().fadeOut(function(){$(this).children().html("")})}},d={elem:a.bookcart,imgobj:a.elem.parent().prev().children().find("img"),mode:2};a.bookcart.children().find(".flow_cart_num").html(b.count),VsmCart.countclose(),VsmCart.countdown(c),a.anItem&&G.addAnimate(d),$("#om_act_url").attr("src",b.om_act_url)}else if(111==b.code&&b.url.length>1)location.href=b.url;else if(b.code>0&&b.msg.length>1)return F.erDialog(b.msg),!1},$.ajax(e)}},tiggerLoginaddCartinit:function(){var a=$('[data-addcart="true"]'),b={elem:a,bookcart:a.prev(),obj:$("[data-mersale]").parent(),jump:a.data("addjump"),anItem:a.data("animate"),product_id:$('input[name="product_id"]').val(),size:a.data("size"),num:a.data("num"),channel_id:$('input[name="channel_id"]').val(),cat_id:$('input[name="cat_id"]').val(),warehouse:$('input[name="warehouse"]').val(),product_name:$('input[name="product_name"]').val(),small_image:$('input[name="small_image"]').val(),vipbook_price:$('input[name="vipbook_price"]').val(),market_price:$('input[name="market_price"]').val(),agio:$('input[name="agio"]').val(),back_url:encodeURIComponent(location.href)};G.tiggeraddCartDo(b)},tiggeraddCartinit:function(){var a=$(this),b={elem:a,bookcart:a.prev(),obj:$("[data-mersale]").parent(),jump:a.data("addjump"),anItem:a.data("animate"),product_id:$('input[name="product_id"]').val(),size:$('input[name="size"]').length?$('input[name="size"]').val():"",num:$('input[name="num"]').val(),channel_id:$('input[name="channel_id"]').val(),cat_id:$('input[name="cat_id"]').val(),warehouse:$('input[name="warehouse"]').val(),product_name:$('input[name="product_name"]').val(),small_image:$('input[name="small_image"]').val(),vipbook_price:$('input[name="vipbook_price"]').val(),market_price:$('input[name="market_price"]').val(),agio:$('input[name="agio"]').val(),back_url:encodeURIComponent(location.href)};G.tiggeraddCartDo(b)},tiggeraddCartDo:function(a){var b=J.tiggerIsEmpty(a.size),c=J.tiggerIsEmpty(a.product_id),d=J.tiggerIsEmpty(a.num);if(!c)return F.erDialog("无法加入购物车：未知异常"),!1;if(!b)return F.erDialog("无法加入购物车：请先选择尺码"),VmPageEffect.sharkError(a.obj,"ui-note-error",!0,0,5,130),!1;if(!d||a.num>1||a.num<=0)return F.erDialog("无法加入购物车：请勿修改数量"),!1;if(1==a.jump){a.elem.html(""),$("<div />",{"class":"lmask"}).html('<img src="view/touch/images/common/loading-big.gif" style="width:20px;margin-right:10px;" /> 加入中...').appendTo(a.elem.parent());var e={url:"index.php?",data:{m:"flow",act:"addtocart",channel_id:a.channel_id,product_id:a.product_id,size:a.size,num:a.num,cat_id:a.cat_id,warehouse:a.warehouse,product_name:a.product_name,small_image:a.small_image,vipbook_price:a.vipbook_price,market_price:a.market_price,agio:a.agio,back_url:a.back_url},dataType:"json",type:"GET"};e.code=function(){a.elem.html("加入购物车").next().remove(),F.erDialog("网络延时，请刷新页面重试！")},e.success=function(b){if(a.elem.html("加入购物车").next().remove(),0==b.code&&b.add_num>0){var c={elem:a.bookcart.children(".num_cunt"),time:b.clear_time,timeUnitCls:{day:"",hour:"",min:":",sec:""},showMin:!0,action:"remain",onEndCallBack:!0,onEndComplete:function(){this.add(this.prev().prev()).fadeOut(function(){$(this).html("").prev().prev().html("")})}},d={elem:a.elem,mode:1};a.bookcart.children(".num_cart").html(b.count).fadeIn("slow"),a.bookcart.children(".num_cunt").fadeIn("slow"),VsmCart.countclose(),VsmCart.countdown(c),a.anItem&&G.addAnimate(d),$("#om_act_url").attr("src",b.om_act_url)}else if(111==b.code&&b.url.length>1)location.href=b.url;else if(b.code>0&&b.msg.length>1)return F.erDialog(b.msg),!1},$.ajax(e)}},getScroll:function(){return self.pageYOffset?{scrollTop:self.pageYOffset,scrollLeft:self.pageXOffset}:document.documentElement&&document.documentElement.scrollTop?{scrollTop:document.documentElement.scrollTop,scrollLeft:document.documentElement.scrollLeft}:document.body?{scrollTop:document.body.scrollTop,scrollLeft:document.body.scrollLeft}:void 0},addAnimatedraw:function(a){var b=G.getScroll();a.addBox.css({left:(a.winW-a.addBox.width())/2,top:(a.winH-a.addBox.height())/2}).show().animate({width:a.endWidth,top:a.endOffset.top-b.scrollTop-a.endHeight/5,left:a.endOffset.left-2},1e3,function(){$(this).fadeOut(function(){$(this).remove()})})},addAnimate:function(a){if(1==a.mode)var b=a.elem.prev().children(".carticon"),c=$("<img />",{src:""+$('[data-cartimg="img"]').children("li:eq(0)").find("img").attr("src")});else if(2==a.mode){a.elem.is(":hidden")?a.elem.fadeIn("fast"):"";var b=a.elem.children().find(".flow_carticon"),c=$("<img />",{src:""+a.imgobj.data("original")})}var d={endOffset:b.offset(),endWidth:b.outerWidth(),endHeight:b.outerHeight(),winW:$(window).width(),winH:$(window).height(),addBox:$("<div />",{"class":"imgModal hide"})};c.appendTo(d.addBox),d.addBox.appendTo(document.body),G.addAnimatedraw(d)}},H={tiggerWrapinit:function(){var a,b=$(this),c={elem:b,id:parseInt(b.data("brandid")),Pid:b.data("pos")},d=$("<span />",{"class":"booked"}).html("<em></em>已订阅"),e=$("<span />",{"class":"bookd"}).html('<em class="sbooked"></em>已订阅'),f=$("<dd />",{"class":"brandover"}),g=$("<span />",{"class":"logoover"}),h=Cookie.Get("WAP[brand_subscribe]");a=void 0==h||"undefined"==h||""==h?"":decodeb64(h),VsmCart.VsmDialog('<input type="text" name="phone" value="'+a+'" class="text_input" style="border:1px solid #ccc;height:30px;line-height:30px;font-size:14px;width:100%;box-shadow:0 0 3px rgba(0,0,0,0.1)"/>',{title:"输入手机号，免费接收特卖提醒",overClose:!1,position:[{top:40},{left:10}],buttons:!0,type:"submit",onCloseComplete:function(a,b){var h={mobileV:b.parent().prev().children().find('input[name="phone"]').val()},i=J.validateMobile(h.mobileV,"手机号码");i&&!isNaN(c.id)&&""!=c.id&&c.id&&(VsmCart.VsmDClose(),$.ajax({url:"brand-date-subscribe.html",data:{mobile:h.mobileV,brand_id:c.id},dataType:"json",type:"POST",success:function(a){a&&null!=a&&void 0!=a?"success"==a.code?(Cookie.Set("WAP[brand_subscribe]",rstr2b64(h.mobileV),17520,"","/"),"1"==c.Pid?c.elem.children().filter(".booked").length||(d.appendTo(c.elem),f.appendTo(c.elem.parent())):"2"==c.Pid&&(c.elem.children().filter(".bookd").length||(e.appendTo(c.elem),g.css({top:c.elem.offset().top,left:c.elem.offset().left}).appendTo(c.elem.parent())))):F.erDialog(a.msg):F.erDialog("网络延时，请刷新页面重试！")},error:function(){F.erDialog("网络延时，请刷新页面重试！")}}))}})}},I={sizeDefault:function(){var a=saveProValue(),b={product_id:parseInt(a.product_id),brand_id:parseInt(a.brand_id),userUrl:"ajaxapi-productsizes.html?"};return{wapDom:b}},tiggerMerSize:function(){var a=$(this),b={elem:a,clsName:a.attr("class"),size:parseInt(a.data("size"),10),input:a.parent().next().filter('input[name="size"]'),pars:a.parent(),parent:a.parent().parent(),index:a.parent().children().index(this),top:a.position().top+parseInt(a.css("marginTop"))-60,left:a.position().left+(a.innerWidth()/2-15),getsize:a.parent().data("mersale")};"choose"==b.clsName&&b.elem.addClass("select").siblings("li").filter(".choose").removeClass("select").parent().next().filter('input[name="size"]').val(b.size),b.getsize&&(void 0==b.pars.data("saveData")?I.GetProSize(b):I.SaveProSize(b.pars.data("saveData"),b))},GetProSize:function(a){var b=I.sizeDefault();$.ajax({url:b.wapDom.userUrl+"s="+(new Date).getTime(),data:{act:b.wapDom.act,productid:b.wapDom.product_id,brandid:b.wapDom.brand_id},dataType:"json",success:function(b){I.SaveProSize(b,a),a.pars.data("saveData",b)}})},SaveProSize:function(a,b){$.each(a,function(c){var d=a[c],e=b.parent;if(d.content.length>0&&"array"==d.type){e.find(".J_wrap_tableBox").html()&&e.find(".J_wrap_tableBox").remove();var f=Math.ceil(99999*Math.random());e.append('<div class="J_wrap_tableBox" id="J_wrap_table'+f+'"></div>'),$("#J_wrap_table"+f).css({opacity:0}).prepend('<div class="J_wrap_tableInfo"><a class="J_close">x</a><div class="J_arrow"></div><table class="J_wrap_sizeTable hidden" border="0" cellspacing="0" cellpadding="0" width="100%" bordercolor="#CCCACC" id="J_wrap_sizeTemplate"><tbody id="J_tableBody"></tbody></table></div>'),$("#J_wrap_table"+f).children().find("table").removeClass("hidden"),$_tableHtml="",$_tableHtml+="<tr>",$.each(d.content[0],function(a,b){$_tableHtml+=""==b?"<th>/</th>":"<th>"+b+"</th>"}),$_tableHtml+="</tr>",$_tableHtml+="<tr>",$.each(d.content[b.index+1],function(a,b){$_tableHtml+=""==b?"<td>/</td>":"<td>"+b+"</td>"}),$_tableHtml+="</tr>",$("#J_wrap_table"+f).children().find("table").children("#J_tableBody").prepend($_tableHtml),$("#J_wrap_table"+f).children().children(".J_arrow").css({left:b.left}),$("#J_wrap_table"+f).css({top:b.top}).fadeTo(500,.85)}}),$(".J_close").on("click.closeJprosize",function(){$(this).parents(".J_wrap_tableBox").dequeue().fadeOut("fast",function(){$(this).remove()})})}},J={tiggerIsEmpty:function(a){return""==$.trim(a)?0:1},validateEmpty:function(a){var b=J.tiggerIsEmpty(a)?a:"",c=arguments[1]?arguments[1]:"";return""==b?(VsmCart.VsmDialog(c+"不能为空",{title:"唯品会提醒您",position:[{top:0},{left:0}],overClose:!1,overShow:!1,width:"100%"}),!1):void 0},validateMobile:function(a){var b=J.tiggerIsEmpty(a)?a:"",c=arguments[1]?arguments[1]:"";return check=arguments[2]?arguments[2]:!1,check&&"boolean"==typeof check?void(b.length>0?a.next().next().attr("disabled",!1).removeClass("btn_gry").addClass("btn_red"):a.next().next().attr("disabled",!0).removeClass("btn_red").addClass("btn_gry")):E.m.test(b)?!0:""==b?(F.erDialog(c+"不能为空"),!1):(F.erDialog(c+"格式错误"),!1)},validatePsw:function(a){var b=J.tiggerIsEmpty(a.psw1.val())?a.psw1.val():"";if(a.psw2&&a.psw2.length){var c=J.tiggerIsEmpty(a.psw2.val())?a.psw2.val():"";return""==b?(F.erDialog(a.txt+"不能为空"),a.psw1.focus(),!1):b.length<6||b.length>20?(F.erDialog(a.txt+"长度错误，请输入6-20位字母和数字的组合！"),a.psw1.focus(),!1):isNaN(b)&&"-1"==b.search(E.s)?c!=b?(F.erDialog("两次输入密码不一样！"),a.psw2.focus(),!1):!0:(F.erDialog(a.txt+"格式错误，请使用字母和数字组合！"),a.psw1.focus(),!1)}return""==b?(F.erDialog(a.txt+"不能为空"),a.psw1.focus(),!1):b.length<6||b.length>20?(F.erDialog(a.txt+"长度错误，请输入6-20位字母和数字的组合！"),a.psw1.focus(),!1):isNaN(b)&&"-1"==b.search(E.s)?!0:(F.erDialog(a.txt+"格式错误，请使用字母和数字组合"),a.psw1.focus(),!1)}},K={tiggerpswCheckinit:function(a){var b=(a.elem,{psw1:$('input[name="pswfirst"]'),psw2:$('input[name="pswend"]'),txt:"密码"}),c=J.validatePsw(b);c&&$.ajax({url:"user-wallet-bind-set.html?",data:{ajax:1,password:b.psw2.val()},dataType:"json",success:function(a){a&&null!=a&&void 0!=a?0==a.code?a.data.url&&""!=a.data.url&&(location.href=a.data.url):F.erCenDialog(1==a.code?a.msg:"网络超时，请刷新重试"):F.erCenDialog("网络超时，请刷新重试")},error:function(){F.erCenDialog("网络超时，请刷新重试")}})},tiggerverCheckinit:function(){var a=$(this),b={elem:a,pars:a.parent(),Method:a.attr("data-bindmethod"),input:a.parent().children().filter('input[name="check_code"]').val(),mobileobj:a.parent().children().filter('input[name="phone"]'),mobileval:a.parent().children().filter('input[name="phone"]').val(),mobilei:parseInt(a.parent().children().filter('[data-getvercode="code"]').data("setmobile"),10)};if(b.mobileobj.length&&void 0!=b.mobileobj)var c=J.tiggerIsEmpty(b.input,"验证码"),d=J.validateMobile(b.mobileval,"手机号码");else var c=J.tiggerIsEmpty(b.input,"验证码"),d=J.validateMobile(b.mobilei,"手机号码");c&&d&&K.tiggerverCheck(b)},tiggerverCheck:function(a){$.ajax({url:"user-wallet-bind-check.html?"+(new Date).getTime(),data:{check_code:a.input,phone:a.mobileobj.length?a.mobileval:a.mobilei},dataType:"json",success:function(b){b&&null!=b&&void 0!=b?0==b.code?"string"==typeof a.Method&&("wallet"==a.Method?location.href="user-wallet-bind-set.html":"next"==a.Method&&a.pars.fadeOut("fast",function(){var b=$(this).next(),c={elem:b,sMethod:b.children('input[type="button"]').data("savamethod"),event1:b.children('input[name="password"]'),event2:b.children('input[name="pswend"]')};$(this).next().show(),"string"==typeof c.sMethod&&("changemobile"==c.sMethod?(Q.inputOpera.call(c.event1,1),c.elem.delegate('[data-savamethod="changemobile"]',"click.method.changemobile",K.tiggerChangeMobile),$("<input />",{type:"hidden",name:"oldphone",value:a.mobilei}).appendTo(c.elem)):"changepsw"==c.sMethod&&(Q.inputOpera.call(c.event2,1),c.elem.delegate('[data-savamethod="changepsw"]',"click.method.changepsw",K.tiggerChangePsw)))})):F.erCenDialog(1==b.code?b.msg:"网络超时，请刷新重试"):F.erCenDialog("网络超时，请刷新重试")},error:function(){F.erCenDialog("网络超时，请刷新重试")}})},tiggerChangeMobile:function(){var a=$(this),b={elem:a,mobile:a.parent().children().filter("input[name=phone]").val(),psw1:a.parent().children().filter("input[name=password]"),txt:"密码",oldPhone:a.next('input[name="oldphone"]').val()},c=J.validateMobile(b.mobile,"手机号码"),d=J.validatePsw(b);if(c&&d){var e={url:"user-wallet-bind-update.html?",data:{ajax:1,old_phone:b.oldPhone,new_phone:b.mobile,password:b.psw1.val()},dataType:"json",type:"GET"};K.tiggerCMethod(e)}},tiggerChangePsw:function(){var a=$(this),b={elem:a,mobile:a.parent().children().filter("input[name=phone]").val(),psw1:a.parent().children().filter('input[name="pswfirst"]'),psw2:a.parent().children().filter('input[name="pswend"]'),txt:"密码"},c=J.validateMobile(b.mobile,"手机号码"),d=J.validatePsw(b);if(c&&d){var e={url:"user-wallet-reset-index.html?",data:{ajax:1,phone:b.mobile,password:b.psw2.val()},dataType:"json",type:"GET"};K.tiggerCMethod(e)}},tiggerCMethod:function(a){a.error=function(){F.erCenDialog("网络超时，请刷新重试")},a.success=function(a){a&&null!=a&&void 0!=a?0==a.code?a.data.url&&""!=a.data.url&&(location.href=a.data.url):F.erCenDialog(1==a.code?a.msg:"网络超时，请刷新重试"):F.erCenDialog("网络超时，请刷新重试")},$.ajax(a)},tiggergetCodeinit:function(){var a=$(this),b={elem:a,mobileobj:a.prev().filter('input[name="phone"]'),mobileval:a.prev().filter('input[name="phone"]').val(),mobilei:parseInt(a.data("setmobile"),10),time:60,showMsg:"倒计时",timeUnitCls:{day:"",hour:"",min:"",sec:"秒"},showMin:!1,action:"remain",onEndCallBack:!0,onEndComplete:function(){this.html("获取验证码").attr("disabled",!1)}};if(b.mobileobj.length&&void 0!=b.mobileobj){var c=J.validateMobile(b.mobileval,"手机号码");c&&K.tiggerGetCode(b)}else{var c=J.validateMobile(b.mobilei,"手机号码");c&&K.tiggerGetCode(b)}},tiggerGetCode:function(a){$.ajax({url:"user-wallet-bind-send.html?",data:{ajax:1,phone:a.mobileobj.length?a.mobileval:a.mobilei},type:"GET",dataType:"json",success:function(b){b&&null!=b&&void 0!=b?0==b.code?(a.elem.attr("disabled",!0),VsmCart.countdown(a),VsmCart.VsmDialog(b.msg,{setClass:"ui-success",overShow:!1,overClose:!1,position:[{top:0},{left:0}],width:"100%",autoClose:3e3})):F.erCenDialog(1==b.code?b.msg:"网络超时，请刷新重试"):F.erCenDialog("网络超时，请刷新重试")},error:function(){F.erCenDialog("网络超时，请刷新重试")}})},tiggerFBSendinit:function(){if("send"===$(this).attr("data-fbmethod")){var a=$(this),b=a.parents('[data-feedback="send"]'),c={elem:a,elemTxt:a.val(),reason:b.find('textarea[name="reason"]').val(),order:b.find('input[name="order_sn"]').val()};if(!J.tiggerIsEmpty(c.order))return F.erDialog("无法提交：未知异常"),!1;if(!J.tiggerIsEmpty(c.reason))return F.erDialog("配送留言不能为空"),VmPageEffect.sharkError(c.reason.parent(),"ui-note-error",!1,0,5,50),!1;var d={url:"acs-ccps.html?",data:{"do":"extform",reason:c.reason,order_sn:c.order},dataType:"json",type:"POST"};K.tiggerFBSend(c,d)}else if("return"===$(this).attr("data-fbmethod")){var a=$(this),b=a.parents('[data-feedback="send"]'),c={elem:a,elemTxt:a.val(),company:b.find('input[name="wl_company"]').val(),ordersn:b.find('input[name="wl_ordersn"]').val(),reason:b.find('textarea[name="reason"]').val(),order:b.find('input[name="order_sn"]').val()};if(!J.tiggerIsEmpty(c.order))return F.erDialog("无法提交：未知异常"),!1;if(!J.tiggerIsEmpty(c.company))return F.erDialog("回寄物流公司不能为空"),VmPageEffect.sharkError(b.find('input[name="wl_company"]').parent(),"ui-note-error",!1,0,5,50),!1;if(!J.tiggerIsEmpty(c.ordersn))return F.erDialog("回寄运单单号不能为空"),VmPageEffect.sharkError(b.find('input[name="wl_ordersn"]').parent(),"ui-note-error",!1,0,5,50),!1;if(!J.tiggerIsEmpty(c.reason))return F.erDialog("退款原因不能为空"),VmPageEffect.sharkError(b.find('textarea[name="reason"]').parent(),"ui-note-error",!1,0,5,50),!1;var d={url:"acs-cctk.html?",data:{"do":"extform",wl_company:c.company,wl_ordersn:c.ordersn,reason:c.reason,order_sn:c.order},dataType:"json",type:"POST"};K.tiggerFBSend(c,d)}else if("set"===$(this).attr("data-fbmethod")){var a=$(this),b=a.parents('[data-feedback="send"]'),c={elem:a,elemTxt:a.val(),fpheader:b.find('input[name="fpheader"]').val(),consignee:b.find('input[name="consignee"]').val(),mobile:b.find('input[name="mobile"]').val(),province:b.find('select[name="province"] option:selected').val(),city:b.find('select[name="city"] option:selected').val(),district:b.find('select[name="district"] option:selected').val(),street:b.find('select[name="street"] option:selected').val(),address:b.find('textarea[name="address"]').val(),order:b.find('input[name="order_sn"]').val()};
if(!J.tiggerIsEmpty(c.order))return F.erDialog("无法提交：未知异常"),!1;if(!J.tiggerIsEmpty(c.fpheader))return F.erDialog("发票抬头不能为空"),VmPageEffect.sharkError(b.find('input[name="fpheader"]').parent(),"ui-note-error",!1,0,5,50),!1;if(!J.tiggerIsEmpty(c.consignee))return F.erDialog("收货人不能为空"),VmPageEffect.sharkError(b.find('input[name="consignee"]').parent(),"ui-note-error",!1,0,5,50),!1;if(!J.tiggerIsEmpty(c.mobile))return F.erDialog("手机号码不能为空"),VmPageEffect.sharkError(b.find('input[name="mobile"]').parent(),"ui-note-error",!1,0,5,50),!1;if(J.tiggerIsEmpty(c.mobile)&&!E.m.test(c.mobile))return F.erDialog("手机号码格式不正确"),VmPageEffect.sharkError(b.find('input[name="mobile"]').parent(),"ui-note-error",!1,0,5,50),!1;if(J.tiggerIsEmpty(c.province)&&c.province<1)return F.erDialog("请选择省"),VmPageEffect.sharkError(b.find('select[name="province"]').parent(),"ui-note-error",!1,0,5,50),!1;if(J.tiggerIsEmpty(c.city)&&c.city<1)return F.erDialog("请选择市"),VmPageEffect.sharkError(b.find('select[name="city"]').parent(),"ui-note-error",!1,0,5,50),!1;if(J.tiggerIsEmpty(c.district)&&c.district<1)return F.erDialog("请选择区"),VmPageEffect.sharkError(b.find('select[name="district"]').parent(),"ui-note-error",!1,0,5,50),!1;if(!J.tiggerIsEmpty(c.address))return F.erDialog("请填写详细地址"),VmPageEffect.sharkError(b.find('textarea[name="address"]').parent(),"ui-note-error",!1,0,5,50),!1;var d={url:"acs-bjfp.html?",data:{"do":"extform",fpheader:c.fpheader,consignee:c.consignee,mobile:c.mobile,province:c.province,city:c.city,district:c.district,street:c.street,address:c.address,order_sn:c.order},dataType:"json",type:"POST"};K.tiggerFBSend(c,d)}},tiggerFBSend:function(a,b){a.elem.val(""),$("<div />",{"class":"ui-btn-mask"}).css({height:a.elem.outerHeight()}).html('<img src="view/touch/images/common/loading-big.gif" style="width:20px;" /> '+a.elem.attr("data-loading-text")).appendTo(a.elem.parent()),b.success=function(b){a.elem.val(a.elemTxt).next().remove(),b&&null!=b&&void 0!=b?1==b.status?(VsmCart.VsmDialog(b.msg+"页面正在跳转",{setClass:"ui-success",overShow:!1,overClose:!1,position:[{top:0},{left:0}],width:"100%",autoClose:3e3}),setTimeout(function(){self.location.href=b.url},2e3)):F.erDialog(0==b.status?b.msg:"网络延时，提交失败"):F.erDialog("网络延时，提交失败")},b.error=function(){a.elem.val(a.elemTxt).next().remove(),F.erDialog("网络延时，提交失败")},$.ajax(b)}},L={triggerChooseTime:function(){var a=$(this),b={elem:a,selt:a.children().filter("span.radio-box"),sibs:a.siblings("li")};b.selt.addClass("radio-selted").next().filter('input[type="radio"]').attr("checked",!0),b.selt.hasClass("radio-selted")&&b.sibs.children().filter("span.radio-box").removeClass("radio-selted").next().filter('input[type="radio"]').attr("checked",!1)},triggerChoosePayway:function(){var a=$(this),b={elem:a,selt:a.children().filter("span.radio-box"),sibs:a.siblings("li"),child:a.siblings("li").children(".dropdiv"),slide:!1};b.selt.addClass("radio-selted").next().filter('input[type="radio"]').attr("checked",!0),b.selt.hasClass("radio-selted")&&(b.sibs.children().filter("span.radio-box").removeClass("radio-selted").next().filter('input[type="radio"]').attr("checked",!1),$.each(b.sibs,function(){$(this).hasClass("bankpay")&&($(this).children().filter('input[type="radio"]').attr("data-bankid","").attr("data-type","").parent().find("li").children("span").removeClass("sz_seleted"),$(this).children("p").html("银行卡(<em>请选择支付卡种</em>)"),L.triggerBankUp.call(b))}))},triggerBankList:function(){var a=$(this),b={elem:a,child:a.parent().children(".dropdiv"),scrol:a.parent(),slide:!1};b.child.is(":hidden")?L.triggerBankDown.call(b):L.triggerBankUp.call(b)},triggerBankDown:function(){this.child.slideDown("fast").prev().removeClass("up_arrow").addClass("down_arrow").parent().css({height:"auto"}),$("body,html").animate({scrollTop:this.elem.offset().top},200)},triggerBankUp:function(){var a=this.scrol;this.slide?this.child.slideUp("fast",function(){$("body,html").animate({scrollTop:a.offset().top-44},200)}).prev().removeClass("down_arrow").addClass("up_arrow"):this.child.slideUp("fast").prev().removeClass("down_arrow").addClass("up_arrow")},triggerBankMenu:function(){var a=$(this),b={elem:a,index:a.parent().children().index(this),next:a.parent().next().children("ul")};b.elem.children("span").hasClass("cur")?"":(b.elem.children("span").addClass("cur").parent().siblings().children("span").removeClass("cur"),b.next.filter(":visible").fadeOut("fast",function(){b.next.eq(b.index).fadeIn("fast")}))},triggerChooseWallet:function(){var a=$(this),b=nWalletMoney();dom={elem:a,isBind:parseInt(a.children().filter('input[name="wallet"]').data("isbind")),isEnough:parseInt(a.children().filter('input[name="wallet"]').data("enpay")),money:b.wallet,totleMoney:b.total,wallet:a.children().filter('input[name="wallet"]'),walletPsw:a.children().filter('input[name="wallet"]').next('input[name="wallet_password"]')},isNaN(dom.isBind)||(1==dom.isBind?dom.money?void 0==dom.wallet.attr("checked")&&!dom.walletPsw.val()||"undefined"==dom.wallet.attr("checked")&&!dom.walletPsw.val()?L.triggerWTPsw(dom):L.triggerWCPsw(dom):F.erDialog("您的钱包金额为0元，无法使用钱包支付！"):0==dom.isBind&&L.triggerWalletToBind(dom))},triggerWCPsw:function(a){a.isEnough?(a.walletPsw.val("").prev().filter('input[name="wallet"]').val(""),a.elem.children().filter("span.check-box").removeClass("check-selted").next().filter('input[name="wallet"]').attr("checked",!1),a.elem.next().find('input[name="pay_type"]').attr("checked",!1).prev("span.radio-box").removeClass("radio-selted"),a.elem.next().find('input[name="pay_type"]').each(function(){$(this).parent().is(":hidden")?$(this).parent().slideDown("fast"):$(this).parent().hasClass("bankpay")&&$(this).next().next().filter("p").html("银行卡(<em>请选择支付卡种</em>)")})):(a.walletPsw.val("").prev().filter('input[name="wallet"]').val(""),a.elem.children().filter("span.check-box").removeClass("check-selted").next().filter('input[name="wallet"]').attr("checked",!1))},triggerWTPsw:function(a){a.isEnough?(a.elem.children().filter("span.check-box").addClass("check-selted").next().filter('input[name="wallet"]').attr("checked",!0),a.elem.next().find('input[name="pay_type"]').each(!isNaN(a.totleMoney-a.money)&&a.totleMoney-a.money>0&&a.totleMoney-a.money<11?function(){50==$(this).val()?$(this).attr("checked",!0).prev().removeClass("radio-selted"):8==$(this).val()?($(this).parent().slideUp("fast"),$(this).attr("checked",!1).prev().removeClass("radio-selted")):$(this).parent().hasClass("bankpay")?($(this).attr("checked",!1).prev().removeClass("radio-selted"),$(this).next().next().filter("p").html("银行卡(<em>请选择支付卡种</em>)")):$(this).attr("checked",!1).prev().removeClass("radio-selted")}:function(){50==$(this).val()?$(this).attr("checked",!0).prev().removeClass("radio-selted"):8==$(this).val()?($(this).parent().slideDown("fast"),$(this).attr("checked",!1).prev().removeClass("radio-selted")):$(this).parent().hasClass("bankpay")?($(this).attr("checked",!1).prev().removeClass("radio-selted"),$(this).next().next().filter("p").html("银行卡(<em>请选择支付卡种</em>)")):$(this).attr("checked",!1).prev().removeClass("radio-selted")})):a.elem.children().filter("span.check-box").addClass("check-selted").next().filter('input[name="wallet"]').attr("checked",!0)},triggerWalletToBind:function(){location.href="user-wallet-bind-send.html"},tiggerInvoice:function(){var a=$(this),b={elem:a,pars:a.parent(),next:a.parent().next()};b.next.is(":hidden")?b.pars.slideUp().next().slideDown():(b.pars.slideUp().next().slideDown(),b.pars.slideUp().prev().slideDown(),b.elem.parent().prev().children().find(".companyname").html(""!=$.trim(b.elem.parent().children().filter('input[name="invoice"]').val())?b.elem.parent().children().filter('input[name="invoice"]').val():"点击填写发票"))},tiggerOrderForm:function(){var a=localStorage.getItem("pay_fail");if(window.localStorage&&a&&null!=a&&void 0!=a){if(a=$.evalJSON(a),a.showLayout&&a.orders){var b=new Array(a.orders,a.is_supplier,a.address_id,a.paytype_id,a.bank_id,a.is_cashier);b=rstr2b64(b.join(":")),VsmCart.VsmDialog("您的支付是否遇到问题？请继续支付...",{title:"您的订单已经提交",overClose:!1,buttons:!0,type:"ordersubmit",closeBtn:!1,onCloseCallBack:!0,onCancleComplete:function(){localStorage.removeItem("pay_fail"),VsmCart.VsmDClose()},onCloseComplete:function(){localStorage.removeItem("pay_fail"),VsmCart.VsmDClose(),location.href="cart-payresult.html?oi="+b}})}return!1}var c=$(this).parents('[data-formorder="checkoutForm"]'),d={elem:$(this),address_id:c.find('input[name="address_id"]').val(),area_id:c.find("input[name='area_id']").val(),area_name:c.find("input[name='area_name']").val(),wallet:c.find("input[name='wallet']").length?c.find("input[name='wallet']"):null,walletPsw:c.find("input[name='wallet_password']"),wallet_password:c.find("input[name='wallet_password']").val(),payType:c.find("input[name='pay_type']"),pay_type:parseInt(c.find("input[name='pay_type']:checked").val()),pay_bank:c.find("input[name='pay_type']:checked"),transport:c.find("input[name='transport_day']"),transport_day:c.find("input[name='transport_day']:checked").val(),favourable_id:c.find("input[name='favourable_id']").val(),invoice:c.find("input[name='invoice']").val()};return d.pay_type<0?d.pay_type=-1*d.pay_type:d.pay_type,!d.transport.is(":checked")&&void 0==typeof d.transport_day||!d.transport.is(":checked")&&"undefined"==typeof d.transport_day?(F.erDialog("请选择收货时间"),VmPageEffect.sharkError($('[data-cartforms="time"]'),"ui-note-error",!0,0,5,44),!1):null!=d.wallet&&d.wallet.is(":checked")&&d.wallet_password.length<1&&""==d.wallet_password?(VsmCart.VsmDialog('<div class="ui-group"><div class="ui-c-group"><input name="wPsw" type="password" class="binput" placeholder="请输入密码" style="font-size:16px;color:#999" /></div><div class="ui-c-group" style="display:none;"></div></div>',{title:'请输入钱包支付密码<a href="user-wallet-reset-index.html" class="fr colorblue">忘记密码？</a>',isCenter:!1,overClose:!1,buttons:!0,type:"submit",onCloseCallBack:!0,closeBtn:!1,onCloseComplete:function(a,b){var c={elem:b,psw1:b.parent().prev().children().find('input[name="wPsw"]'),txt:"密码"},e=J.tiggerIsEmpty(c.psw1.val())?c.psw1.val():"";return""==e?(c.psw1.parent().next().addClass("error").html(c.txt+"不能为空").show(),c.psw1.focus(),!1):e.length<6||e.length>20?(c.psw1.parent().next().addClass("error").html("请输入6-20位字母和数字的组合！").show(),c.psw1.focus(),!1):isNaN(e)&&"-1"==e.search(E.s)?(d.walletPsw.val(rstr2b64(c.psw1.val())).prev().filter('input[name="wallet"]').val(1),VsmCart.VsmDClose(),L.tiggerOrderSub(d),void 0):(c.psw1.parent().next().addClass("error").html(c.txt+"格式错误，请使用字母和数字组合").show(),c.psw1.focus(),!1)}}),!1):(L.tiggerOrderSub(d),!1)},tiggerOrderSub:function(a){if(void 0==a.payType.length&&"undefined"==a.payType.length)return F.erDialog("请选择支付方式"),VmPageEffect.sharkError($('[data-cartforms="payway"]').children(".in_pay"),"ui-note-error",!0,0,5,44),!1;if(!a.payType.is(":checked")&&isNaN(a.pay_type))return F.erDialog("请选择支付方式"),VmPageEffect.sharkError($('[data-cartforms="payway"]').children(".in_pay"),"ui-note-error",!0,0,5,44),!1;if(a.pay_type<1)return F.erDialog("请选择支付方式"),VmPageEffect.sharkError($('[data-cartforms="payway"]').children(".in_pay"),"ui-note-error",!0,0,5,44),!1;if(a.transport.is(":checked")&&a.transport_day&&a.payType.is(":checked")&&!isNaN(a.pay_type)){if(a.elem.children().filter(".cart_time_smb").hide(),$("<div />",{"class":"lmask"}).html('<img src="view/touch/images/common/loading-big.gif" style="width:20px;margin-right:10px;margin-left:20px;float:left;" />').appendTo(a.elem.parent()),a.pay_bank.val()<0&&2===a.pay_type)var b={url:"index.php?m=flow&act=done",data:{address_id:a.address_id,area_id:a.area_id,area_name:a.area_name,transport_day:a.transport_day,paytype_id:a.pay_bank.attr("data-type"),bank_id:a.pay_bank.attr("data-bankid"),is_cashier:a.pay_bank.attr("data-cashier"),favourable_id:a.favourable_id,invoice:a.invoice,wallet:null!=a.wallet?a.wallet.val():"",wallet_password:null!=a.wallet?a.walletPsw.val():""},dataType:"json",type:"POST"};else var b={url:"index.php?m=flow&act=done",data:{address_id:a.address_id,area_id:a.area_id,area_name:a.area_name,transport_day:a.transport_day,paytype_id:a.pay_type,favourable_id:a.favourable_id,invoice:a.invoice,wallet:null!=a.wallet?a.wallet.val():"",wallet_password:null!=a.wallet?a.walletPsw.val():""},dataType:"json",type:"POST"};b.error=function(){a.elem.children().filter(".cart_time_smb").show().parent().next().remove(),F.erDialog("网络延时，提交订单失败！")},b.success=function(b){if(a.elem.children().filter(".cart_time_smb").show().parent().next().remove(),b&&null!=b&&void 0!=b)if(100==b.error){if(window.localStorage&&localStorage.removeItem("paytype"),b.url&&setTimeout(function(){self.location.href=b.url},500),b.orders&&8!==a.pay_type&&window.localStorage){var c=new Object;c=b,c.showLayout=1,localStorage.setItem("pay_fail",$.toJSON(c))}}else{if(101==b.error&&b.msg)return VsmCart.VsmDialog("您的订单已经提交，购物车为空，请刷新页面！ ^_^",{title:"您的订单已经提交",overClose:!1,buttons:!0,type:"confirm",onCloseCallBack:!0,onCloseComplete:function(){self.location.href=location.href}}),!1;if(b.error>101&&b.msg)return F.erDialog(b.msg),106==b.error&&a.walletPsw.val(""),!1}else F.erDialog("网络延时，提交订单失败！")},$.ajax(b)}},tiggerOrderFailForm:function(){var a=$(this).parents('[data-formorder="checkfailForm"]'),b={elem:$(this),html:$(this).html(),width:$(this).outerWidth(),mLeft:$(this).outerWidth()/2,payType:a.find("input[name='pay_type']"),pay_type:a.find("input[name='pay_type']:checked").val(),pay_bank:a.find("input[name='pay_type']:checked"),ispos:a.find("input[name='pay_type']:checked").attr("data-ispos"),orders:a.find("input[name='pay_type']:checked").attr("data-orders"),bankid:a.find("input[name='pay_type']:checked").attr("data-bankid"),cashier:a.find("input[name='pay_type']:checked").attr("data-cashier")};return b.pay_type<0?b.pay_type=-1*b.pay_type:b.pay_type,console.log(b.pay_bank.val()),void 0==b.payType.length&&"undefined"==b.payType.length?(F.erDialog("请选择支付方式"),VmPageEffect.sharkError(a.children('[data-twicecart="payway"]'),"ui-note-error",!0,0,5,44),!1):!b.payType.is(":checked")&&isNaN(b.pay_type)?(F.erDialog("请选择支付方式"),VmPageEffect.sharkError(a.children('[data-twicecart="payway"]'),"ui-note-error",!0,0,5,44),!1):b.pay_type<1?(F.erDialog("请选择支付方式"),VmPageEffect.sharkError(a.children('[data-twicecart="payway"]'),"ui-note-error",!0,0,5,44),!1):(L.triggerTwicePayDo(b),!1)},triggerTwicePayDo:function(a){if(a.elem.html(""),$("<div />",{"class":"ui-btn-mask"}).css({width:a.width,marginLeft:-a.mLeft,left:"50%",height:a.elem.outerHeight(),top:parseInt(a.elem.css("marginTop"))}).html('<img src="view/touch/images/common/loading-big.gif" style="width:20px;" /> '+a.elem.attr("data-loading-text")).appendTo(a.elem.parent()),a.pay_type&&a.pay_bank.val()<0&&2===a.pay_type)var b={url:"index.php?",data:{m:"ajax",act:"modify_order_paytype",orders:a.orders,pay_type:a.pay_bank.attr("data-type"),use_pos:a.ispos,bank_id:a.bankid,is_cashier:a.cashier},dataType:"json",type:"POST"};else var b={url:"index.php?",data:{m:"ajax",act:"modify_order_paytype",orders:a.orders,pay_type:a.pay_type,use_pos:a.ispos},dataType:"json",type:"POST"};b.success=function(b){a.elem.html(a.html).next().remove(),b&&null!=b&&void 0!=b?1==b.code?b.repay_url?location.href=b.repay_url:8==a.pay_type&&(location.href=b.order_detail_url):0==b.code&&F.erCenDialog(b.msg):F.erDialog("网络延时，提交订单失败")},b.error=function(){a.elem.html(a.html).next().remove(),F.erDialog("网络延时，提交订单失败")},$.ajax(b)},triggerChooseBankCart:function(){var a=$(this),b=a.parents("li").children().filter('input[name="pay_type"]'),c={elem:a,child:a.parents(".dropdiv"),childs:a.children().filter("span"),id:a.children().filter("span").data("bankid"),type:parseInt(a.children().filter("span").attr("data-type")),selbox:a.parents("li").children().filter("span.radio-box"),sibs:a.parents("li").siblings("li").children().filter("span.radio-box"),prev:a.parent().parent().prev().children().children().filter("span.cur"),scrol:a.parents("li"),slide:!0,pay_type:parseInt(b.val()),pay_bank:parseInt(b.val()),pay:a.parent().parent().attr("data-twipay"),orders:b.attr("data-orders"),ispos:b.attr("data-ispos"),payid:a.children().filter("span").attr("data-type"),bankid:a.children().filter("span").attr("data-bankid"),cashier:b.attr("data-cashier"),showText:a.parents(".bankpay").children().filter("p")};c.pay_type<0?c.pay_type=-1*c.pay_type:c.pay_type,c.pay="true"===c.pay?!0:!1,c.childs.hasClass("sz_seleted")?(c.selbox.addClass("radio-selted").next().filter('input[type="radio"]').attr("data-bankid",c.id).attr("data-type",c.type).attr("checked",!0),c.sibs.hasClass("radio-selted")&&c.sibs.removeClass("radio-selted").next().filter('input[type="radio"]').attr("checked",!1)):(c.childs.addClass("sz_seleted").parent().siblings().children().filter("span").removeClass("sz_seleted"),c.elem.parent().siblings().children().children().filter("span").removeClass("sz_seleted"),c.selbox.addClass("radio-selted").next().filter('input[type="radio"]').attr("data-bankid",c.id).attr("data-type",c.type).attr("checked",!0),c.sibs.hasClass("radio-selted")&&c.sibs.removeClass("radio-selted").next().filter('input[type="radio"]').attr("checked",!1),c.showText.html(c.elem.text()),"boolean"==typeof c.pay&&c.pay&&L.triggerTwicePayDo(c),L.triggerBankUp.call(c))}},M={triggerAddBonus:function(){var a=$(this),b={pars:a.parent(),val:a.prev().val(),pageUrl:a.next().val(),type:parseInt(a.attr("data-bonustype"))};switch(b.type){case 1:var c={url:"index.php",data:{m:"user",act:"bonus",step:"add",favourable_code:b.val},dataType:"json",type:"POST"};b.txt="请输入代金券号码",M.triggerAddBonusTo(c,b);break;case 2:var c={url:"index.php",data:{m:"user",act:"giftcard",step:"add",favourable_code:b.val},dataType:"json",type:"POST"};b.txt="请输入礼品卡号码",M.triggerAddBonusTo(c,b);break;case 3:var c={url:"index.php",data:{m:"user",act:"coupon",step:"add",favourable_code:b.val},dataType:"json",type:"POST"};b.txt="请输入抵用券号码",M.triggerAddBonusTo(c,b);break;default:o.buttons=["取消"]}},triggerAddBonusTo:function(a,b){return""==b.val||""==b.val.length||b.val.length<1?(F.erDialog(b.txt),!1):(a.success=function(a){a&&null!=a&&void 0!=a&&(0==a.code?(VsmCart.VsmDialog(a.msg,{setClass:"ui-success",overShow:!1,overClose:!1,position:[{top:0},{left:0}],width:"100%",autoClose:3e3}),setTimeout(function(){self.location.href=location.href},3e3)):F.erDialog(1==a.code?a.msg:"网络延时，请刷新页面重试！"))},a.error=function(){F.erDialog("网络延时，请刷新页面重试！")},$.ajax(a),void 0)},tiggeruseBonus:function(a,b){var a=a,c="您已经使用了";return 1>a?!1:void $.get("index.php?m=flow&act=bonus&step=use_bonus",{bonus_id:a},function(a){if(1==a.code)switch(b){case 1:VsmCart.VsmDialog(c+"代金券",{setClass:"ui-success",overShow:!1,overClose:!1,position:[{top:0},{left:0}],width:"100%",autoClose:3e3}),self.location.href=a.url;break;case 2:VsmCart.VsmDialog(c+"礼品卡",{setClass:"ui-success",overShow:!1,overClose:!1,position:[{top:0},{left:0}],width:"100%",autoClose:3e3}),self.location.href=a.url}},"json")},tiggeruseCoupon:function(){var a=new Array,b="您已经使用了";return $.each($("input[name='coupon']"),function(b,c){1==c.checked&&a.push(c.value)}),a.length<1?void F.erDialog("请选择抵用券"):void $.post("index.php?m=flow&act=bonus&step=use_coupon",{coupons:a.join(",")},function(a){if(1==a.code)VsmCart.VsmDialog(b+"抵用券, 正在跳回购物车页面",{setClass:"ui-success",overShow:!1,overClose:!1,position:[{top:0},{left:0}],width:"100%",autoClose:3e3}),setTimeout(function(){self.location.href="cart.html"},3e3);else if(-1==a.code)return F.erDialog("购物车中的预订不满足使用抵用券条件"),!1},"json")},triggerSelCoupon:function(){var a=$(this),b={elem:a,child:a.children().filter("input"),check:a.children().filter('input[name="coupon"]')};b.child.is(":radio")?b.elem.hasClass("selected")||b.check.attr("checked")?"":b.elem.addClass("selected").children().filter('input[name="coupon"]').attr("checked",!0).parent().siblings('[data-selcoupon="true"]').removeClass("selected").children().filter('input[name="coupon"]').attr("checked",!1):b.elem.hasClass("selected")||b.check.attr("checked")?b.elem.removeClass("selected").children().filter('input[name="coupon"]').attr("checked",!1):b.elem.addClass("selected").children().filter('input[name="coupon"]').attr("checked",!0).parent().siblings('[data-selcoupon="true"]').children().filter('input[type="radio"]').attr("checked",!1).parent().removeClass("selected")}},N={triggerTabselect:function(){var a=$(this),b={elem:a,child:a.children(),index:q.children().index(this)};b.child.addClass("nav_current").parent().siblings().children().filter("a").removeClass("nav_current"),r.filter(":visible").fadeOut("fast",function(){r.eq(b.index).fadeIn("fast")})},autoSetTabselect:function(){this.pars.children("li").length&&(this.pars.children("li").filter(":eq(0)").children("a").addClass("nav_current"),this.next.filter(":eq(0)").show().siblings(".use-bonus").hide())},triggerAutoTab:function(){this.pars.children("li").filter(":eq("+(this.id-1)+")").children("a").addClass("nav_current").parent().siblings().children().filter("a").removeClass("nav_current"),this.next.filter(":eq("+(this.id-1)+")").show().siblings(".use-bonus").hide()},triggerBonusFocus:function(){var a=$(this),b={elem:a,next:a.parent().next().filter("div.inputtips"),nextBtn:a.next().filter('input[type="button"]'),clsName:a.attr("data-cname")};b.elem.addClass("focus").parent().next().filter("div.inputtips").fadeIn("fast"),b.nextBtn.removeClass("btn_gry").addClass(""+b.clsName).attr("disabled",!1)},triggerBonusBlur:function(){var a=$(this),b={elem:a,next:a.parent().next().filter("div.inputtips"),nextBtn:a.next().filter('input[type="button"]'),clsName:a.attr("data-cname")};b.next.fadeOut("fast"),""!=b.elem.val()&&b.elem.val().length?b.nextBtn.removeClass("btn_gry").addClass(""+b.clsName).attr("disabled",!1):b.nextBtn.removeClass(""+b.clsName).addClass("btn_gry").attr("disabled",!0)},triggerChecked:function(){this.next.text("反选"),this.checkBox.attr("checked","checked")},triggerNotChecked:function(){this.next.text("全选"),this.checkBox.attr("checked",!1)},triggerCheckBonus:function(){var a=$(this),b={elem:a,next:a.next(),checkBox:a.parents("table").children().find('input[name="coupon"]').filter('input[type="checkbox"]')};b.elem.is(":checked")?M.triggerChecked.call(b):M.triggerNotChecked.call(b)}},O={triggerChooseallList:function(){var a=$(this),b={elem:a,child:a.children("span.check-box"),nspan:a.next().find("span.check-box")};b.child.hasClass("check-selted")?O.triggerClAll.call(b):O.triggerChAll.call(b)},triggerChAll:function(){this.child.addClass("check-selted"),this.nspan.addClass("check-selted").next().filter('input[name="good_id"]').attr("checked",!0)},triggerClAll:function(){this.child.removeClass("check-selted"),this.nspan.removeClass("check-selted").next().filter('input[name="good_id"]').attr("checked",!1)},triggerChooseList:function(){var a=$(this),b={elem:a,child:a.children("span.check-box"),pspan:a.parent().prev().children("span.check-box"),silb:a.siblings(".orderdeatil").children("span.check-box")};b.child.hasClass("check-selted")?O.triggerClThis.call(b):O.triggerChThis.call(b)},triggerChThis:function(){this.child.addClass("check-selted").next().filter('input[name="good_id"]').attr("checked",!0),this.pspan.addClass("check-selted")},triggerClThis:function(){this.child.removeClass("check-selted").next().filter('input[name="good_id"]').attr("checked",!1),(!this.silb.hasClass("check-selted")&&void 0==this.silb.next().filter('input[name="good_id"]').attr("checked")||!this.silb.hasClass("check-selted")&&"undefined"==this.silb.next().filter('input[name="good_id"]').attr("checked"))&&this.pspan.removeClass("check-selted")},triggerChooseReason:function(){var a=$(this),b={elem:a,child:a.children("i"),rid:parseInt(a.attr("data-reasonid")),rinput:a.parent().children('input[name="reason_id"]')};!isNaN(b.rid)&&b.rid&&b.child.hasClass("seleted")?O.triggerCLsel.call(b):O.triggerCRsel.call(b)},triggerCRsel:function(){this.child.addClass("seleted").parent().siblings().filter("a").children().removeClass("seleted"),this.rinput.val(this.rid)},triggerCLsel:function(){this.child.removeClass("seleted"),this.rinput.val("")},triggerChooseWay:function(){var a=$(this),b={elem:a,child:a.children("i"),rid:a.attr("data-backway"),rinput:a.parent().children('input[name="return_type"]')};!isNaN(b.rid)&&b.child.hasClass("seleted")?O.triggerCLsel.call(b):O.triggerCRsel.call(b)},triggerOrderSub:function(){var a=($(this),{goodid:$('input[name="good_id"]'),reson:$('input[name="reason_id"]').val(),way:$('input[name="return_type"]').val(),orderid:$('input[name="order_sn"]').val(),formact:$('input[name="form_act"]').val()}),b=new Array,c=J.tiggerIsEmpty(a.reson),d=J.tiggerIsEmpty(a.way);if($.each(a.goodid,function(a,c){1==c.checked&&b.push(c.value)}),b.length<1)return F.erDialog("请选择退货预订"),!1;if(!c)return F.erDialog("请选择退货原因"),!1;if(!d)return F.erDialog("请选择余额退回方式"),!1;var e={url:"index.php?",data:{m:"user",act:"order",step:"return",form_act:a.formact,good_id:b.join(","),reason_id:a.reson,return_type:a.way,order_sn:a.orderid},dataType:"json",type:"POST"};e.success=function(a){a&&null!=a&&void 0!=a?1==a.status?(VsmCart.VsmDialog(a.msg+"页面正在跳转",{setClass:"ui-success",overShow:!1,overClose:!1,position:[{top:0},{left:0}],width:"100%",autoClose:3e3}),setTimeout(function(){self.location.href=a.url},3e3)):F.erDialog(0==a.status?a.msg:"退货失败，请刷新页面重试"):F.erDialog("退货失败，请刷新页面重试")},e.error=function(){F.erDialog("退货失败，请刷新页面重试")},$.ajax(e)}},P={triggerAddressinit:function(){var a=$(this),b=$(this).parents().filter('form[name="addressForm_"]'),c={elem:a,elemTxt:a.val(),address_id:b.find('input[name="address_id"]').val(),filter:b.find('input[name="filter"]').val(),flag:b.find('input[name="flag"]').val(),mkobj:b.find('input[name="mk"]'),consignee:b.find('input[name="consignee"]').val(),province_id:b.find('select[name="province"] option:selected').val(),city_id:b.find('select[name="city"] option:selected').val(),district_id:b.find('select[name="district"] option:selected').val(),street_id:b.find('select[name="street"] option:selected').val(),address:b.find('textarea[name="address"]').val(),mobile:b.find('input[name="mobile"]').val(),postcode:b.find('input[name="postcode"]').val()};if("undefined"==c.mkobj||void 0==c.mkobj)var d="";else var d=c.mkobj.val();if("update"==c.filter&&c.address_id.length<1)return F.erDialog("地址异常"),!1;if(c.consignee.length<1)return F.erDialog("请填写收货人姓名"),b.find('input[name="consignee"]').focus(),VmPageEffect.sharkError($('input[name="consignee"]').parent(),"ui-note-error",!1,0,5,50),!1;if(!E.c.test($.trim(c.consignee)))return F.erDialog("请填写1~8位中文姓名"),b.find('input[name="consignee"]').focus(),VmPageEffect.sharkError($('input[name="consignee"]').parent(),"ui-note-error",!1,0,5,50),!1;if(c.mobile.length<1&&""==c.mobile)return F.erDialog("手机号码不能为空"),b.find('input[name="mobile"]').focus(),VmPageEffect.sharkError($('input[name="mobile"]').parent(),"ui-note-error",!1,0,5,50),!1;if(c.mobile.length>0&&!E.m.test(c.mobile))return F.erDialog("手机号码格式错误"),b.find('input[name="mobile"]').focus(),VmPageEffect.sharkError($('input[name="mobile"]').parent(),"ui-note-error",!1,0,5,50),!1;if(null==c.province_id||c.province_id<1)return F.erDialog("请选择省"),VmPageEffect.sharkError($('select[name="province"]').parent(),"ui-note-error",!1,0,5,50),!1;if(null==c.city_id||c.city_id<1)return F.erDialog("请选择市"),VmPageEffect.sharkError($('select[name="city"]').parent(),"ui-note-error",!1,0,5,50),!1;if(null==c.district_id||c.district_id<1)return F.erDialog("请选择区"),VmPageEffect.sharkError($('select[name="district"]').parent(),"ui-note-error",!1,0,5,50),!1;if(c.address.length<1)return F.erDialog("请填写详细地址"),VmPageEffect.sharkError($('textarea[name="address"]').parent(),"ui-note-error",!1,0,5,50),!1;if(6!=c.postcode.length||isNaN(c.postcode))return F.erDialog("邮编错误"),VmPageEffect.sharkError($('input[name="postcode"]').parent(),"ui-note-error",!1,0,5,50),!1;if(c.filter&&c.consignee&&c.province_id&&c.city_id&&c.district_id&&c.address&&c.mobile&&c.postcode){c.elem.val(""),$("<div />",{"class":"ui-btn-mask"}).css({height:c.elem.outerHeight()}).html('<img src="view/touch/images/common/loading-big.gif" style="width:20px;" /> '+c.elem.attr("data-loading-text")).appendTo(c.elem.parent());var e={url:"index.php?m=user&act=address&step=save",data:{filter:c.filter,address_id:c.address_id,consignee:c.consignee,province:c.province_id,city:c.city_id,district:c.district_id,street:c.street_id,address:c.address,postcode:c.postcode,mobile:c.mobile,flag:c.flag,mk:d},dataType:"json",type:"POST"};e.success=function(a){c.elem.next().remove(),c.elem.val(c.elemTxt),1==a.error&&a.message.length>0?"default"==ui?alert(a.message):F.erDialog(a.message):-1==a.error&&a.url.length>0&&(location.href=a.url)},e.error=function(){c.elem.next().remove(),c.elem.val(c.elemTxt),F.erDialog("网络延时，请刷新页面重试！")},$.ajax(e)}return!1},triggerDelAddress:function(){var a=$(this),b={elem:a,id:parseInt(a.attr("data-addressid"))};!isNaN(b.id)&&b.id&&VsmCart.VsmDialog("您确定要删除地址吗？",{title:"唯品会友情提醒您",buttons:!0,type:"confirm",onCloseComplete:function(){var a={url:"index.php?",data:{m:"user",act:"address",step:"edit",filter:"del",address_id:b.id},dataType:"json",type:"POST"};a.success=function(a){a&&null!=a&&void 0!=a&&0==a.code&&(VsmCart.VsmDialog(a.msg,{setClass:"ui-success",overShow:!1,overClose:!1,position:[{top:0},{left:0}],width:"100%",autoClose:3e3}),setTimeout(function(){self.location.href=location.href},3e3))},a.error=function(){F.erDialog("网络延时，请刷新页面重试！")},$.ajax(a)}})}},Q={inputInit:function(){var a={icheck:$('input[name="check_code"]').length?$('input[name="check_code"]'):null,wcheck:$('input[name="pswend"]').length?$('input[name="pswend"]'):null,txtcheck:$('[data-feedback="send"]').find('textarea[name="reason"]').length?$('[data-feedback="send"]').find('textarea[name="reason"]'):null};null!=a.icheck&&Q.inputOpera.call(a.icheck,1),null!=a.wcheck&&Q.inputOpera.call(a.wcheck,1),null!=a.txtcheck&&Q.inputOpera.call(a.txtcheck,2)},inputOpera:function(a){1==a?this.length&&this.on("keyup",function(){""!=$.trim($(this).val())&&$(this).val().length>0?$(this).next().next().attr("disabled",!1).removeClass("btn_gry").addClass("btn_red"):$(this).next().next().attr("disabled",!0).removeClass("btn_red").addClass("btn_gry")}).on("change",function(){""!=$.trim($(this).val())&&$(this).val().length>0?$(this).next().next().attr("disabled",!1).removeClass("btn_gry").addClass("btn_red"):$(this).next().next().attr("disabled",!0).removeClass("btn_red").addClass("btn_gry")}):2==a&&this.length&&this.on("keyup",function(){""!=$.trim($(this).val())&&$(this).val().length>0?$(this).parents('[data-feedback="send"]').find("[data-fbmethod]").attr("disabled",!1).removeClass("btn_gry").addClass("btn_red"):$(this).parents('[data-feedback="send"]').find("[data-fbmethod]").attr("disabled",!0).removeClass("btn_red").addClass("btn_gry")}).on("change",function(){""!=$.trim($(this).val())&&$(this).val().length>0?$(this).parents('[data-feedback="send"]').find("[data-fbmethod]").attr("disabled",!1).removeClass("btn_gry").addClass("btn_red"):$(this).parents('[data-feedback="send"]').find("[data-fbmethod]").attr("disabled",!0).removeClass("btn_red").addClass("btn_gry")})},cartInit:function(){var a={elem:$('[data-bookcarthide="true"]').length},b={elem:$('[data-bookcart="true"]').find(".flow_cart_time"),time:parseInt($('[data-bookcart="true"]').attr("bookcarttime")),timeUnitCls:{day:"",hour:"",min:":",sec:""},action:"remain",onEndCallBack:!0,onEndComplete:function(){this.html(""),this.parent().parent().fadeOut("fast")}};a.elem?$(".bookpingbags").remove():b.elem.length&&b.time>0&&VsmCart.countdown(b)},tabInit:function(){var a=location.href,b=VmPageEffect.localUrl(a),c={pars:q,next:r,id:parseInt(b.params.tab)};c.id?N.triggerAutoTab.call(c):N.autoSetTabselect.call(c)},bindEvents:function(){a.off("click.button.code").on("click.button.code",K.tiggergetCodeinit),b.off("click.button.method").on("click.button.method",K.tiggerverCheckinit),c.off("click.button.psw").on("click.button.psw",K.tiggerpswCheckinit),d.off("click.button.feedbacksend").on("click.button.feedbacksend",K.tiggerFBSendinit),e.off("click.choice.size","li").on("click.choice.size","li",I.tiggerMerSize),f.off("click.add.cart",'[data-addcart="true"]').on("click.add.cart",'[data-addcart="true"]',G.tiggeraddCartinit),g.off("click.add.beauty").on("click.add.beauty",G.tiggerBeautyaddCartinit),h.off("click.choose.wrap").on("click.choose.wrap",H.tiggerWrapinit),i.off("click.orderform.set").on("click.orderform.set",L.tiggerOrderForm),j.off("click.orderfailform.set").on("click.orderfailform.set",L.tiggerOrderFailForm),k.children().find("li").off("click.choose.time").on("click.choose.time",L.triggerChooseTime),l.children(".in_pay").children().children().filter("li.otherpay").off("click.choose.pay").on("click.choose.pay",L.triggerChoosePayway),l.children(".in_pay").children().children().filter("li.bankpay").children("p").off("click.choose.bankpay").on("click.choose.bankpay",L.triggerBankList),l.children(".payinwallet").off("click.choose.wallet").on("click.choose.wallet",L.triggerChooseWallet),n.children().children().filter("li.otherpay").off("click.twicechoose.pay").on("click.twicechoose.pay",L.triggerChoosePayway),n.children().children().filter("li.bankpay").children("p").off("click.twicechoose.pay").on("click.twicechoose.pay",L.triggerBankList),p.off("click.twiceChoose.wallet").on("click.twiceChoose.wallet",L.triggerChooseWallet),m.children().children().filter("h3").off("click.invoice.set").on("click.invoice.set",L.tiggerInvoice),v.children(".orderlisttit").off("click.reorder.list").on("click.reorder.list",O.triggerChooseallList),v.children().children().filter(".orderdeatil").off("click.reorder.list").on("click.reorder.list",O.triggerChooseList),w.children().filter("a").off("click.rereason.reason").on("click.rereason.reason",O.triggerChooseReason),x.children().filter("a").off("click.reway.way").on("click.reway.way",O.triggerChooseWay),y.off("click.Ordersub.sub").on("click.Ordersub.sub",O.triggerOrderSub),z.off("click.commit.address").on("click.commit.address",P.triggerAddressinit),A.off("click.del.address").on("click.del.address",P.triggerDelAddress),C.children().filter("li").off("click.choose.banktype").on("click.choose.banktype",L.triggerBankMenu),D.children().children().filter("li").off("click.choose.carttype").on("click.choose.carttype",L.triggerChooseBankCart)
},bindBonusEvents:function(){q.children("li").off("click.select.tab").on("click.select.tab",N.triggerTabselect),s.children('input[name="favourable_code"]').on("focus",N.triggerBonusFocus).on("blur",N.triggerBonusBlur),t.off().off("click.CheckBonus").on("click.CheckBonus",N.triggerCheckBonus),u.off("click.add.Bonus").on("click.add.Bonus",M.triggerAddBonus),B.off("click.selCoupon").on("click.selCoupon",M.triggerSelCoupon)},autoEvent:function(){q.length&&Q.tabInit()},init:function(){Q.bindEvents(),Q.inputInit(),Q.cartInit(),Q.autoEvent(),Q.bindBonusEvents()}};return{init:Q.init,useBonus:M.tiggeruseBonus,useCoupon:M.tiggeruseCoupon,validatePsw:J.validatePsw,erDialog:F.erDialog,sizeDefault:I.sizeDefault,getSize:I.tiggerMerSize,erDialog:F.erDialog,addcart:G.tiggerLoginaddCartinit,beautyaddcart:G.tiggerLoginBaddCartinit}}();$(function(){VsmwebForm.init()});